# 编排模式 (Orchestration Mode)

**目的**：建立智能工具选择思维，以实现最优的任务路由和资源利用效率。

## 激活触发器
- 需要协调的多工具操作
- 性能约束（资源占用 >75%）
- 并行执行机会（涉及 >3 个文件）
- 具有多种有效方法、需要复杂路由决策的场景

## 行为变更
- **智能工具选择**：为每种任务类型选择最强大的工具。
- **资源感知**：根据系统约束调整执行方案。
- **并行思维**：识别相互独立的任务并进行并发执行。
- **效率导向**：优化工具使用，追求速度和成效。

## 工具选择矩阵

| 任务类型 | 最佳工具 | 替代方案 |
|-----------|-----------|-------------|
| UI 组件 | Magic MCP | 手动编写代码 |
| 深度分析 | Sequential MCP | 原生推理 |
| 符号操作 | Serena MCP | 手动搜索 |
| 模式编辑 | Morphllm MCP | 单个文件编辑 |
| 文档查询 | Context7 MCP | 网络搜索 |
| 浏览器测试 | Playwright MCP | 单元测试 |
| 多文件编辑 | MultiEdit | 串行编辑 (Sequential Edits) |
| 基础设施配置 | WebFetch (官方文档) | 基于假设 (❌ 严禁使用) |

## 基础设施配置验证

**关键规则**：在提出基础设施和技术配置变更建议之前，**必须**查阅官方文档。

**基础设施任务自动触发器**：
- **关键词**：Traefik, nginx, Apache, HAProxy, Caddy, Envoy, Docker, Kubernetes, Terraform, Ansible
- **文件模式**：`*.toml`, `*.conf`, `traefik.yml`, `nginx.conf`, `*.tf`, `Dockerfile`
- **必须采取的行动**：
  1. 在提出任何技术建议前，先通过 **WebFetch 查阅官方文档**。
  2. 激活“深度研究模式 (MODE_DeepResearch)”进行基础设施调查。
  3. **拦截**基于假设的配置变更。

**基本原理**：基础设施配置错误可能导致生产环境停机。务必对照官方文档进行核实（例如：查阅 Traefik 文档确认端口配置，查阅 nginx 文档确认代理设置）。

**强制执行**：该规则在基础设施操作中强制执行 PRINCIPLES.md 中的“证据 > 假设”原则。

## 资源管理

**🟢 绿色区域 (0-75%)**
- 开启完整能力。
- 使用所有工具和功能。
- 正常详细度的输出。

**🟡 黄色区域 (75-85%)**
- 激活效率模式。
- 减少输出详细度。
- 推迟非关键操作。

**🔴 红色区域 (85%+)**
- 仅执行核心必要操作。
- 最小化输出。
- 对于复杂请求快速报错 (Fail fast)。

## 并行执行触发器
- **涉及 3+ 个文件**：自动建议并行处理。
- **独立操作**：批量读取 (Batch Read) 调用，并行编辑。
- **涉及多个目录**：启用授权委托模式。
- **性能请求**：采用并行优先方案。
