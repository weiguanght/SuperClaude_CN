# 测试规程与 CI/CD (Procedures)

## 测试配置

### pytest 设置
- **测试目录**: `tests/`
- **测试文件模式**: `test_*.py`, `*_test.py`
- **测试类**: `Test*`
- **测试函数**: `test_*`
- **选项**: `-v --tb=short --strict-markers`

### 覆盖率设置
- **对象**: `superclaude/`, `setup/`
- **排除**: `*/tests/*`, `*/test_*`, `*/__pycache__/*`
- **目标**: 90% 以上的覆盖率
- **报告**: 使用 `show_missing = true` 显示未覆盖的行

### 测试标记
- `@pytest.mark.slow`: 慢速测试（可通过 `-m "not slow"` 排除）
- `@pytest.mark.integration`: 集成测试

## 现有测试文件
- `tests/test_get_components.py`：组件获取测试
- `tests/test_install_command.py`：安装命令测试
- `tests/test_installer.py`：安装程序测试
- `tests/test_mcp_component.py`：MCP 组件测试
- `tests/test_mcp_docs_component.py`：MCP 文档组件测试
- `tests/test_ui.py`：UI 测试

## 任务完成时的必须检查清单

### 1. 代码质量检查
运行 Black 格式化、Mypy 类型检查及 Flake8 代码规范检查。

### 2. 测试执行
确保所有测试通过，且代码覆盖率达到 90% 以上。

### 3. 文档更新
新增功能或变更 API 后，需同步更新相应的文档、docstring 和使用示例。

### 4. Git 操作
遵循 Conventional Commits 规范进行提交，并在提交前仔细确认变更内容。

## CI/CD 工作流 (GitHub Actions)
- **publish-pypi.yml**: 自动发布至 PyPI。
- **readme-quality-check.yml**: README 及文档质量自动检查。

### 触发条件
- **推送 (Push)**: 运行代码规范检查与测试。
- **拉取请求 (PR)**: 运行质量检查与覆盖率验证。
- **创建标签 (Tag)**: 自动发布新版本至 PyPI。

## 质量标准

### 代码质量
- 必须通过所有测试。
- 新功能的测试覆盖率需达到 90% 以上。
- 完善类型提示 (Type Hints)。
- 完备的异常处理机制。

### 文档质量
- 公共 API 必须有文档说明。
- 包含实际使用案例。
- 兼顾从初学者到高级用户的需求。

### 性能标准
- 针对大型项目进行性能优化。
- 确保跨平台兼容性。
- 实现高效的资源利用。
