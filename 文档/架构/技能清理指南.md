# 技能清理计划 (Skills Cleanup for Clean Architecture)

**日期**：2025-10-21
**问题**：`~/.claude/skills/` 目录下残留有旧版本的技能 (Skills)。
**影响**：Claude Code 在启动时可能需要处理约 64KB (约 15K tokens) 的内容。

---

## 📊 现状分析

### ~/.claude/skills/ 目录内容
- `pm` (PM 智能体技能)
- `pm.backup` (备份)
- `brainstorming-mode`, `business-panel-mode`, `deep-research-mode` 等共计 9 个项目。

### 资源消耗确认
- 全部技能相关的 `implementation.md` 和 `SKILL.md` 文件总计：**64,394 字节 (约 64KB ≈ 15K tokens)**。

---

## 🎯 在简洁架构下的处理方式

### 新架构
- **PM 智能体核心** → `src/superclaude/pm_agent/`：以 Python 模块形式实现，通过 pytest fixtures 调用，**不再污染 `~/.claude/`**。
- **技能 (可选)** → 用户需明示安装：通过 `superclaude install-skill pm-agent` 显式复制到用户配置目录。

---

## ⚠️ 问题：技能的自动加载

### Claude Code 的行为 (推测)
1. 启动时扫描 `~/.claude/`。
2. 读取 `skills/` 下所有的 `.md` 文件。
3. 将内容传递给 Claude。
**结果**：即使不使用，也会白白消耗约 15K tokens。

### 带来的影响
当前本地环境中出现了重复读取的风险：
- ✅ `src/superclaude/pm_agent/` - 新实现 (正在使用中)。
- ❌ `~/.claude/skills/pm/` - 旧技能 (残余代码)。
- ❌ 其他模式相关的旧技能。

---

## 🧹 清理步骤建议

### 方案 1：全部删除 (推荐 - 完全过渡到简洁架构)
- **操作**：备份后，清空 `~/.claude/skills/` 目录。
- **效果**：✅ 回收 15K tokens。✅ 建立纯净状态。✅ 仅保留新架构。

### 方案 2：仅删除 PM 智能体相关技能
- **操作**：由于已有新实现，仅删除 `pm` 和 `pm.backup`。
- **效果**：✅ 解决 PM 智能体的重复读取问题 (回收约 3K tokens)。❌ 其他闲置技能仍会产生 token 消耗。

### 方案 3：按需保留
- **操作**：手动删除不使用的技能，保留如 `deep-research` 和 `orchestration` 等需要的旧版模式。
- **效果**：✅ 灵活度高。❌ 需要持续手动管理。

---

## 📋 推荐行动

### 在实施第三阶段之前
1. **创建备份**。
2. **删除旧版 PM 智能体**。
3. **验证新架构**。
4. **确认资源节省效果**。

### 最终完全过渡后
- **建议执行方案 1 (全删除)** 以达到最大优化效果。

---

## ⚡ 即时执行建议命令

```bash
# 安全地将现有技能目录重命名为备份
cd ~/.claude
mv skills skills.backup.20251021
mkdir skills  # 为 Claude Code 创建一个新的空技能目录

# 确认操作结果
ls -la skills/  # 如果为空，则操作成功
```

**结论**：该操作可立即回收约 15K tokens，且随时可以通过备份进行还原。

---

**状态**：待执行
**建议**：执行方案 1 —— 全面转向简洁架构。
