# SuperClaude 上下文架构指南

## 概述

本指南介绍 SuperClaude 的上下文导向配置框架的结构，以及 Claude Code 如何解读这些上下文文件来调整其行为。

**重要提示**：SuperClaude 并非独立运行的软件，不包含运行进程、执行层或性能系统。它是一组 `.md` 指令文件，供 Claude Code 读取后采用特定行为。

## 目录

1. [上下文文件架构](#上下文文件架构)
2. [导入系统](#导入系统)
3. [代理上下文结构](#代理上下文结构)
4. [命令上下文结构](#命令上下文结构)
5. [模式上下文结构](#模式上下文结构)
6. [MCP 服务器配置](#mcp-服务器配置)
7. [Claude Code 如何读取上下文](#claude-code-如何读取上下文)
8. [扩展框架](#扩展框架)

## 上下文文件架构

### 目录结构

```
~/.claude/ (仅限 SuperClaude 框架文件)
├── CLAUDE.md                       # 主上下文文件（含导入语句）
├── FLAGS.md                        # 标志定义与触发器
├── RULES.md                        # 核心行为规则
├── PRINCIPLES.md                   # 指导原则
├── ZIG.md                          # Zig 语言集成
├── MCP_Context7.md                 # Context7 MCP 集成
├── MCP_Magic.md                    # Magic MCP 集成
├── MCP_Morphllm.md                 # Morphllm MCP 集成
├── MCP_Playwright.md               # Playwright MCP 集成
├── MCP_Sequential.md               # Sequential MCP 集成
├── MCP_Serena.md                   # Serena MCP 集成
├── MCP_Tavily.md                   # Tavily MCP 集成
├── MCP_Zig.md                      # Zig MCP 集成
├── MODE_Brainstorming.md           # 协作探索模式
├── MODE_Business_Panel.md          # 商业专家面板模式
├── MODE_DeepResearch.md            # 深度研究模式
├── MODE_Introspection.md           # 透明推理模式
├── MODE_Orchestration.md           # 工具协调模式
├── MODE_Task_Management.md         # 任务编排模式
├── MODE_Token_Efficiency.md        # 压缩通信模式
├── agents/                         # 领域专家上下文（共 19 个）
│   ├── backend-architect.md        # 后端专家
│   ├── business-panel-experts.md   # 商业策略面板
│   ├── deep-research-agent.md      # 深度研究专家
│   ├── devops-architect.md         # DevOps 专家
│   ├── frontend-architect.md       # 前端专家
│   ├── learning-guide.md           # 教育专家
│   ├── performance-engineer.md     # 性能专家
│   ├── python-expert.md            # Python 专家
│   ├── quality-engineer.md         # 质量保证专家
│   ├── refactoring-expert.md       # 代码质量专家
│   ├── requirements-analyst.md     # 需求专家
│   ├── root-cause-analyst.md       # 问题诊断专家
│   ├── security-engineer.md        # 安全专家
│   ├── socratic-mentor.md          # 教育专家
│   ├── spec-panel-experts.md       # 规格审查面板
│   ├── system-architect.md         # 系统设计专家
│   ├── technical-writer.md         # 文档专家
│   ├── test-runner.md              # 测试执行专家
│   └── wave-orchestrator.md        # 批次编排模式
└── commands/                       # 工作流模式上下文
    └── sc/                         # SuperClaude 命令命名空间（共 25 个）
        ├── analyze.md              # 分析模式
        ├── brainstorm.md           # 探索模式
        ├── build.md                # 构建模式
        ├── business-panel.md       # 商业专家面板模式
        ├── cleanup.md              # 清理模式
        ├── design.md               # 设计模式
        ├── document.md             # 文档模式
        ├── estimate.md             # 估算模式
        ├── explain.md              # 解释模式
        ├── git.md                  # Git 工作流模式
        ├── help.md                 # 帮助与命令列表
        ├── implement.md            # 实现模式
        ├── improve.md              # 改进模式
        ├── index.md                # 索引模式
        ├── load.md                 # 上下文加载模式
        ├── reflect.md              # 反思模式
        ├── research.md             # 深度研究模式
        ├── save.md                 # 会话持久化模式
        ├── select-tool.md          # 工具选择模式
        ├── spawn.md                # 多代理模式
        ├── spec-panel.md           # 规格审查面板
        ├── task.md                 # 任务管理模式
        ├── test.md                 # 测试模式
        ├── troubleshoot.md         # 故障排除模式
        └── workflow.md             # 工作流规划模式

注意：其他目录（backups/、logs/、projects/、serena/ 等）是 Claude Code
的操作目录，不属于 SuperClaude 框架内容。
```

### 上下文文件类型

| 文件类型 | 用途 | 激活方式 | 示例 |
|----------|------|----------|------|
| **命令** | 定义工作流模式 | `/sc:[命令]`（上下文触发） | 用户输入 `/sc:implement` → 读取 `implement.md` |
| **代理** | 提供领域专业知识 | `@agent-[名称]` 或自动 | `@agent-security` → 读取 `security-engineer.md` |
| **模式** | 修改交互风格 | 标志或触发器 | `--brainstorm` → 激活头脑风暴模式 |
| **核心** | 设定基本规则 | 始终激活 | `RULES.md` 始终加载 |

## 导入系统

### CLAUDE.md 的工作原理

主 `CLAUDE.md` 文件使用导入系统来加载多个上下文文件：

```markdown
# CLAUDE

*必选*
@FLAGS.md                  # 标志定义与触发器
@RULES.md                  # 核心行为规则
@PRINCIPLES.md             # 指导原则
*次要*
@MCP_Context7.md           # Context7 MCP 集成
@MCP_Magic.md              # Magic MCP 集成
@MCP_Morphllm.md           # Morphllm MCP 集成
@MCP_Playwright.md         # Playwright MCP 集成
@MCP_Sequential.md         # Sequential MCP 集成
@MCP_Serena.md             # Serena MCP 集成
@MCP_Tavily.md             # Tavily MCP 集成
@MCP_Zig.md                # Zig MCP 集成
*关键*
@MODE_Brainstorming.md     # 协作探索模式
@MODE_Business_Panel.md    # 商业专家面板模式
@MODE_DeepResearch.md      # 深度研究模式
@MODE_Introspection.md     # 透明推理模式
@MODE_Task_Management.md   # 任务编排模式
@MODE_Orchestration.md     # 工具协调模式
@MODE_Token_Efficiency.md  # 压缩通信模式
*语言特定*
@ZIG.md                    # Zig 语言集成
```

### 导入处理流程

1. Claude Code 读取 `CLAUDE.md`
2. 遇到 `@import` 语句
3. 将引用的文件加载到上下文中
4. 构建完整的行为框架
5. 根据用户输入应用相关上下文

## 代理上下文结构

### 代理文件的结构

每个代理 `.md` 文件遵循以下结构：

```markdown
---
name: agent-name
description: 简要描述
category: specialized|architecture|quality
---

# 代理名称

## 触发条件
- 激活此代理的关键词
- 触发激活的文件类型
- 复杂度阈值

## 行为理念
核心理念与方法

## 关注领域
- 领域专业知识 1
- 领域专业知识 2

## 关键操作
1. 具体行为模式
2. 问题解决方法
```

### 代理激活逻辑

- **手动**：用户输入 `@agent-python-expert "任务"`
- **自动**：请求中的关键词触发代理加载
- **上下文**：文件类型或模式激活相关代理

## 命令上下文结构

### 命令文件的结构

```markdown
---
name: command-name
description: 命令用途
category: utility|orchestration|analysis
complexity: basic|enhanced|advanced
mcp-servers: [context7, sequential]
personas: [architect, engineer]
---

# /sc:command-name

## 触发条件
- 何时使用此命令
- 上下文指示器

## 用法
/sc:command-name [目标] [--选项]

## 工作流模式
1. 步骤1：初始操作
2. 步骤2：处理
3. 步骤3：验证

## 示例
实际使用示例
```

### 命令处理流程

当用户在 Claude Code 对话中输入 `/sc:implement "功能"` 时：
1. Claude 读取 `commands/sc/implement.md`
2. 采用实现工作流模式
3. 可能自动激活相关代理
4. 遵循定义的工作流步骤

## 模式上下文结构

### 行为模式

模式会修改 Claude 的交互风格：

```markdown
# MODE_[名称].md

## 激活触发器
- 标志：--mode-name
- 关键词：[触发器]
- 复杂度：阈值

## 行为修改
- 沟通风格变化
- 决策调整
- 输出格式修改

## 交互模式
- 如何响应
- 优先考虑什么
```

## MCP 服务器配置

### 配置位置

MCP 服务器在 `~/.claude.json` 中配置（不属于 SuperClaude 上下文）：

```json
{
  "mcpServers": {
    "context7": {
      "command": "npx",
      "args": ["-y", "@upstash/context7-mcp@latest"]
    },
    "sequential-thinking": {
      "command": "npx",
      "args": ["-y", "sequential-thinking-mcp@latest"]
    }
  }
}
```

### MCP 集成

- **MCP 服务器**：提供工具的实际软件
- **SuperClaude**：告诉 Claude 何时使用它们的上下文
- **激活**：标志或关键词触发 MCP 使用

## Claude Code 如何读取上下文

### 上下文加载序列

```
用户输入（在 Claude Code 中）："/sc:analyze src/ --focus security"
                    ↓
1. 解析命令：识别 'analyze' 命令
                    ↓
2. 加载上下文：读取 commands/sc/analyze.md
                    ↓
3. 检查标志：--focus security
                    ↓
4. 自动激活：加载 security-engineer.md
                    ↓
5. 应用模式：遵循分析工作流
                    ↓
6. 生成输出：使用已加载的上下文
```

### 上下文优先级

1. **显式命令**：`/sc:` 命令优先
2. **手动代理**：`@agent-` 覆盖自动激活
3. **标志**：修改命令/代理的行为
4. **自动激活**：基于关键词/上下文
5. **默认行为**：标准 Claude Code

## 扩展框架

### 添加新命令

1. 创建 `~/.claude/commands/sc/new-command.md`
2. 定义元数据、触发器和工作流
3. 无需代码更改 - 只是上下文

### 添加新代理

1. 创建 `~/.claude/agents/new-specialist.md`
2. 定义专业领域、触发器和行为
3. 代理即可使用

### 添加新模式

1. 创建 `~/.claude/MODE_NewMode.md`
2. 定义激活触发器和修改内容
3. 模式根据触发器激活

### 最佳实践

- **保持上下文聚焦**：每个文件一个概念
- **明确触发器**：定义何时激活上下文
- **工作流模式**：提供逐步指导
- **示例**：包含实际使用示例
- **元数据**：使用 frontmatter 配置

## 重要说明

### SuperClaude 不是什么

- ❌ **无执行引擎**：没有代码运行，没有进程执行
- ❌ **无性能系统**：无法优化（只是文本）
- ❌ **无检测引擎**：Claude Code 进行模式匹配
- ❌ **无编排层**：上下文文件指导而非控制
- ❌ **无质量门禁**：只是指令模式

### SuperClaude 是什么

- ✅ **上下文文件**：供 Claude Code 使用的 `.md` 指令
- ✅ **行为模式**：工作流和方法
- ✅ **领域专业知识**：专业知识上下文
- ✅ **配置**：实际工具（MCP）的设置
- ✅ **框架**：结构化的提示工程

## 总结

SuperClaude 的架构故意保持简单：它是一组精心组织的上下文文件，供 Claude Code 读取以修改其行为。其强大之处来自这些上下文的精心编写和系统化组织，而非任何执行代码或运行进程。

该框架的优雅之处在于其简洁性——通过上下文文件为 Claude Code 提供结构化指令，我们可以在没有任何软件复杂性的情况下实现复杂的行为修改。
