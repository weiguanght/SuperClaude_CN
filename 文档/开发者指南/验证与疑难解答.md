# SuperClaude 验证与疑难解答指南 (Verification and Troubleshooting Guide)

## 概览

本指南介绍了如何验证 SuperClaude 的安装情况，并解决上下文文件和配置中常见的疑难问题。

**重要说明**：SuperClaude 是一个上下文文件的集合，而非可执行软件。本指南的核心在于确保上下文文件已正确安装并可供 Claude Code 访问。

## 目录

1. [安装验证](#安装验证)
2. [上下文文件验证](#上下文文件验证)
3. [MCP 服务器验证](#mcp-服务器验证)
4. [常见问题](#常见问题)
5. [疑难解答命令](#疑难解答命令)

---

## 安装验证

### 检查安装状态

```bash
# 验证 SuperClaude 安装系统是否可用
python3 -m SuperClaude --version
# 预期：显示 SuperClaude 框架的安装说明

# 验证 Claude Code 命令行集成情况
claude --version
# 预期：显示 Claude Code 版本信息

# 检查上下文文件是否已安装
ls ~/.claude/
# 预期：显示 CLAUDE.md, FLAGS.md, RULES.md, agents/, commands/, modes/
```

### 验证目录结构

```bash
# 确认各子目录均已存在
for dir in agents commands modes; do
    if [ -d ~/.claude/$dir ]; then
        echo "✅ $dir 目录已存在"
        ls ~/.claude/$dir | wc -l
    else
        echo "❌ $dir 目录缺失"
    fi
done
```

### 统计组件数量

- **智能体 (Agents)**：`ls ~/.claude/agents/*.md | wc -l` (预期约 15 个)。
- **命令 (Commands)**：`ls ~/.claude/commands/*.md | wc -l` (预期约 21 个)。
- **模式 (Modes)**：`ls ~/.claude/modes/*.md | wc -l` (预期约 6 个)。

---

## 上下文文件验证

### 验证核心文件

```bash
# 检查核心上下文文件是否存在
for file in CLAUDE.md FLAGS.md RULES.md PRINCIPLES.md; do
    if [ -f ~/.claude/$file ]; then
        echo "✅ $file 文件已存在 ($(wc -l < ~/.claude/$file) 行)"
    else
        echo "❌ $file 文件缺失"
    fi
done
```

### 验证导入系统

通过检查 `CLAUDE.md` 是否包含正确的 `@import` 语句来确认导入系统是否生效：
```bash
grep "@import" ~/.claude/CLAUDE.md
```

### 检查文件完整性

确保所有文件均为有效的文本文件且没有损坏：
```bash
file ~/.claude/CLAUDE.md
# 预期：ASCII text 或 UTF-8 text
```

---

## MCP 服务器验证

### 检查配置

确认 `.claude.json` 配置文件是否存在并包含已配置的服务器列表：
```bash
if [ -f ~/.claude.json ]; then
    echo "✅ MCP 配置文件存在"
    grep -o '"[^"]*":' ~/.claude.json | grep -v mcpServers
else
    echo "❌ 未找到 MCP 配置"
fi
```

### 测试 MCP 服务器可用性

- **Node.js**：`node --version` (预期 v16.0.0 或更高版本)。
- **npx**：`npx --version`。

---

## 常见问题

### 问题：命令无法生效

- **现象**：在对话中输入 `/sc:` 触发词，但 Claude Code 的行为没有发生改变。
- **验证**：检查 `~/.claude/commands/` 目录下对应的 `.md` 文件是否存在。
- **解决**：使用安装程序重新安装 `commands` 组件。

### 问题：智能体不被激活

- **现象**：在对话中通过 `@agent-` 调用专家模式无效。
- **验证**：检查 `~/.claude/agents/` 目录下对应的专家文件。
- **解决**：强制重新安装 `agents` 组件。

### 问题：上下文未加载

- **现象**：Claude Code 似乎完全无视了 SuperClaude 的配置。
- **解决**：
  1. 重启 Claude Code。
  2. 确保您当前处于项目目录下。
  3. 检查文件权限：`chmod 644 ~/.claude/*.md`。

---

## 疑难解答命令

### 快速诊断脚本

您可以运行以下简单的 Bash 逻辑进行快速自检：

```bash
echo "=== SuperClaude 快速诊断 ==="
# 检查安装系统
# 检查上下文文件目录及数量
# 检查 MCP 配置
# 检查 Node.js 环境
echo "=== 诊断完成 ==="
```

### 修复文件权限

```bash
# 将上下文文件的权限修复为一般由于读取
chmod 644 ~/.claude/*.md
chmod 644 ~/.claude/**/*.md
chmod 755 ~/.claude ~/.claude/agents ~/.claude/commands ~/.claude/modes
```

### 完全重新安装

```bash
# 备份现有的配置
cp -r ~/.claude ~/.claude.backup.$(date +%Y%m%d)

# 删除现有安装
rm -rf ~/.claude

# 重新安装所有组件
PYTHONPATH=. python3 -m setup install
```

---

## 注意事项

### 我们“不”验证的内容
- **代码执行**：由于上下文文件是纯文本指令，因此不存在运行时验证。
- **性能指标**：没有代码在后台运行，因此无需测量性能。
- **单元测试**：指令集无法通过传统的软件单元测试进行验证。

### 我们“验证”的内容
- **文件存在性**：确保文件位于正确的位置。
- **文件完整性**：文件可读且格式正确。
- **目录结构**：确保组织结构符合规范。
- **配置合法性**：JSON 文件语法正确。
- **行为测试**：在 Claude Code 对话中通过人工测试确认指令生效。

---

## 总结

SuperClaude 的验证重点在于确保上下文文件已正确安装并可供 Claude Code 访问。由于它不是软件产品，而是一个配置框架，因此验证的核心在于文件的存在性、完整性以及在实际对话中的行为表现。
