---
name: select-tool
description: "基于复杂度评分与操作分析的智能 MCP 工具选择"
category: special
complexity: high
mcp-servers: [serena, morphllm]
personas: []
---

# /sc:select-tool - 智能 MCP 工具选择

## 触发场景
- 需要在 Serena 与 Morphllm 之间进行最优 MCP 工具选择的操作。
- 需要复杂度分析与能力匹配的元系统决策。
- 需要权衡性能 (Performance) 与准确度 (Accuracy) 的工具路由决策。
- 从智能工具能力评估中获益的操作。

## 用法
```
/sc:select-tool [操作内容] [--analyze] [--explain]
```

## 行为流程
1. **解析 (Parse)**：分析操作类型、范围、文件数量及复杂度指标。
2. **评分 (Score)**：对各种操作因素应用多维度的复杂度评分。
3. **匹配 (Match)**：将操作要求对照 Serena 与 Morphllm 的能力进行匹配。
4. **选择 (Select)**：根据评分矩阵和性能要求选择最优工具。
5. **验证 (Validate)**：校对选择的准确度并提供置信度指标。

核心行为：
- 基于文件数量、操作类型、语言及框架要求的复杂度评分。
- 评估速度与准确度之间权衡的性能评估，以实现最优选择。
- 具备直接映射与基于阈值的路由规则的决策逻辑矩阵。
- 对 Serena（语义操作）与 Morphllm（模式操作）的能力匹配。

## MCP 集成
- **Serena MCP**：最适用于语义操作、LSP 功能、符号导航及项目上下文。
- **Morphllm MCP**：最适用于基于模式的编辑、批量转换及对速度要求极高的操作。
- **决策矩阵**：基于复杂度评分与操作特征的智能路由。

## 工具协作
- **get_current_config**：用于工具能力评估的系统配置分析。
- **execute_sketched_edit**：用于校对选择准确度的操作测试与验证。
- **Read/Grep**：操作内容分析与复杂度因素识别。
- **集成**：由 refactor, edit, implement, improve 等命令使用的自动选择逻辑。

## 关键模式
- **直接映射**：符号操作 → Serena；模式编辑 → Morphllm；记忆操作 → Serena。
- **复杂度阈值**：分值 >0.6 → Serena；分值 <0.4 → Morphllm；0.4-0.6 → 基于具体特性。
- **性能权衡**：速度要求 → Morphllm；准确度要求 → Serena。
- **回退策略**：Serena → Morphllm → 原生工具的降级链。

## 示例

### 复杂的重构操作
```
/sc:select-tool "在 10 个文件中重命名函数" --analyze
```
# 分析：高复杂度 (涉及多文件、符号操作)
# 选择：Serena MCP (利用 LSP 能力及语义理解)

### 基于模式的批量编辑
```
/sc:select-tool "在整个项目中将 console.log 更新为 logger.info" --explain
```
# 分析：基于模式的转换，速度优先
# 选择：Morphllm MCP (匹配模式，批量操作)

### 记忆管理操作
```
/sc:select-tool "保存项目上下文与发现"
```
# 直接映射：记忆操作 → Serena MCP
# 理由：涉及项目上下文与跨会话持久化

## 边界

**能力范围：**
- 分析操作并在 Serena 与 Morphllm 之间提供最优工具选择。
- 根据文件数量、操作类型及需求应用复杂度评分。
- 在 100ms 内做出决策，且准确率 >95%。

**非能力范围：**
- 当用户有明确偏好时覆盖显式的工具指定。
- 在没有经过适当复杂度分析与能力匹配的情况下选择工具。
- 为了便利性或速度而牺牲性能要求。
