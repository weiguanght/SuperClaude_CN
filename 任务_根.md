# 任务 (TASK.md)

**SuperClaude 框架当前的开发任务、优先级和待办事项**

> 本文档用于跟踪当前的开发任务、优先级和项目待办事项。
> 建议在每个开发会话开始时阅读此文件，以了解下一步的工作内容。

**最后更新日期**：2025-11-12

---

## 🚨 **关键问题 (阻碍发布)**

### ✅ **已完成**

1. **[已完成]** 跨文件版本号不一致
   - ✅ 修复了 VERSION 文件和 README 文件 (提交号 bec0b0c)
   - ✅ 将 package.json 更新至 4.1.7
   - ⚠️ 注意：pyproject.toml 故意保留为 0.4.0 (Python 包版本规范)

2. **[已完成]** 插件系统文档存在误导
   - ✅ 在 CLAUDE.md 中添加了关于 v5.0 状态的警告
   - ✅ 明确了 README.md 中的安装说明
   - ✅ 引用了 issue #419 以进行跟踪

3. **[已完成]** 缺少测试目录
   - ✅ 创建了 tests/ 目录结构
   - ✅ 添加了全面的单元测试 (confidence, self_check, reflexion, token_budget)
   - ✅ 添加了 pytest 插件的集成测试
   - ✅ 添加了包含共享 fixture 的 conftest.py

4. **[已完成]** 缺少关键文档文件
   - ✅ 创建了包含架构和规则的 PLANNING.md
   - ✅ 创建了 TASK.md (即本文档)
   - ✅ 创建了包含洞察的 KNOWLEDGE.md

5. **[已完成]** UV 依赖未安装
   - ✅ 用户已安装 UV
   - 📝 待办：在 README 中添加 UV 安装文档

---

## 🔥 **高优先级 (v4.1.7 补丁版本)**

### 1. 完成占位符实现
**状态**：待处理 (TODO)
**文件**：`src/superclaude/pm_agent/confidence.py`
**行号**：144, 162, 180, 198

**问题**：核心信心检查方法目前仅为占位符：
- `_no_duplicates()` - 应使用 Glob/Grep 搜索代码库
- `_architecture_compliant()` - 应读取 CLAUDE.md 以确认技术栈
- `_has_oss_reference()` - 应在 GitHub 上搜索相关实现
- `_root_cause_identified()` - 应验证问题分析是否准确

**影响**：信心检查功能尚未完全可用

**验收标准**：
- [ ] 在 `_no_duplicates()` 中实现真实的代码搜索
- [ ] 在 `_architecture_compliant()` 中解析 CLAUDE.md
- [ ] 为 `_has_oss_reference()` 集成网络搜索
- [ ] 在 `_root_cause_identified()` 中添加全面的验证逻辑
- [ ] 为每个实现添加单元测试
- [ ] 更新包含示例的文档

**预估工作量**：4-6 小时
**优先级**：高

---

### 2. 修复 .gitignore 冲突
**状态**：待处理 (TODO)
**文件**：`.gitignore`
**行号**：102-106

**问题**：冲突的模式导致混乱：
```gitignore
.claude/           # 忽略此目录
!.claude/          # 但又不忽略它？
.claude/*          # 忽略其内容
!.claude/settings.json  # 唯独排除此文件
CLAUDE.md          # 此文件已被跟踪但却出现在这里
```

**解决方案**：
- 从 gitignore 中移除 `.claude/` (它是项目相关的)
- 仅忽略用户特定的文件：`.claude/history/`, `.claude/cache/`
- 从 gitignore 中移除 `CLAUDE.md` (它是项目文档)

**验收标准**：
- [ ] 使用正确的模式更新 .gitignore
- [ ] 验证已跟踪的文件仍保持跟踪状态
- [ ] 在重新克隆的仓库中进行测试

**预估工作量**：30 分钟
**优先级**：中

---

### 3. 添加 UV 安装文档
**状态**：待处理 (TODO)
**文件**：`README.md`, `CLAUDE.md`, `docs/getting-started/installation.md`

**问题**：CLAUDE.md 要求使用 UV，但未说明如何安装

**解决方案**：
- 在 README 中添加 UV 安装说明
- 为不使用 UV 的用户提供备选命令
- 文档说明 UV 的优势 (虚拟环境管理、速度)

**验收标准**：
- [ ] 在 README 中添加 UV 安装章节
- [ ] 提供跨平台的安装命令
- [ ] 添加备选示例 (例如 python -m pytest vs uv run pytest)
- [ ] 更新 CLAUDE.md 中的 UV 设置指南

**预估工作量**：1-2 小时
**优先级**：中

---

### 4. 运行测试套件并修复问题
**状态**：待处理 (TODO)

**任务**：
- [ ] 运行 `uv run pytest -v`
- [ ] 修复所有失败的测试
- [ ] 验证所有 fixture 工作正常
- [ ] 检查测试覆盖率：`uv run pytest --cov=superclaude`
- [ ] 目标覆盖率：>80%

**预估工作量**：2-4 小时
**优先级**：高

---

## 📋 **中优先级 (v4.2.0 次要版本)**

### 5. 实现 Mindbase 集成
**状态**：待处理 (TODO)
**文件**：`src/superclaude/pm_agent/reflexion.py`
**行号**：173

**问题**：Mindbase MCP 集成的 TODO 注释

**背景**：Reflexion 模式应将学到的错误持久化到 Mindbase MCP，以便跨会话学习

**验收标准**：
- [ ] 研究 Mindbase MCP API
- [ ] 实现与 Mindbase 的连接
- [ ] 添加错误持久化到 Mindbase 的功能
- [ ] 添加从 Mindbase 检索错误的功能
- [ ] 使 Mindbase 成为可选组件 (优雅降级)
- [ ] 添加集成测试
- [ ] 编写使用文档

**预估工作量**：6-8 小时
**优先级**：中
**阻塞因素**：Mindbase MCP 的可用性

---

### 6. 添加全面文档
**状态**：进度中 (IN PROGRESS)

**剩余任务**：
- [ ] 添加 API 参考文档
- [ ] 创建 PM 代理模式教程
- [ ] 在 KNOWLEDGE.md 中添加更多示例
- [ ] 文档说明 MCP 服务器集成
- [ ] 创建视频演示 (可选)

**预估工作量**：8-10 小时
**优先级**：中

---

### 7. 改进 CLI 命令
**状态**：待处理 (TODO)
**文件**：`src/superclaude/cli/main.py`

**增强项**：
- [ ] 添加 `superclaude init` 命令 (初始化项目)
- [ ] 添加 `superclaude check` 命令 (运行信心检查)
- [ ] 添加 `superclaude validate` 命令 (运行自检)
- [ ] 改进 `superclaude doctor` 的输出内容
- [ ] 添加进度指示器

**预估工作量**：4-6 小时
**优先级**：中

---

## 🔮 **长期目标 (v5.0 主要版本)**

### 8. TypeScript 插件系统
**状态**：已规划 (PLANNED)
**Issue**：[#419](https://github.com/SuperClaude-Org/SuperClaude_Framework/issues/419)

**描述**：完整的插件系统架构，支持：
- 通过 `.claude-plugin/plugin.json` 进行项目局部插件检测
- 插件市场分发
- 基于 TypeScript 的插件开发
- 自动加载代理、命令、钩子、技能

**阶段性目标**：
- [ ] 设计插件 manifest schema
- [ ] 实现插件发现机制
- [ ] 创建插件 SDK (TypeScript)
- [ ] 构建插件市场后端
- [ ] 将现有命令迁移为插件格式
- [ ] 添加插件 CLI 命令
- [ ] 编写插件开发指南

**预估工作量**：40-60 小时
**优先级**：低 (v5.0)
**状态**：提案阶段

---

### 9. 增强的并行执行
**状态**：已规划 (PLANNED)

**描述**：先进的并行执行模式：
- 自动依赖检测
- 并行波次优化
- 资源池化
- 失败恢复策略

**预估工作量**：20-30 小时
**优先级**：低 (v5.0)

---

### 10. 高级 MCP 集成
**状态**：已规划 (PLANNED)

**描述**：与 MCP 服务器的深层次集成：
- Serena：代码理解 (快 2-3 倍)
- Sequential：Token 高效推理 (减少 30-50%)
- Tavily：增强的 Web 研究
- Context7：官方文档集成
- Mindbase：跨会话记忆

**预估工作量**：30-40 小时
**优先级**：低 (v5.0)

---

## 🐛 **已知问题**

### 非关键 Bug

1. **confidence.py 中存在未使用的的方法**
   - 定义了 `_has_existing_patterns()` 和 `_has_clear_path()` 但从未被调用
   - 考虑移除它们或集成到 `assess()` 中
   - 优先级：低

2. **cli/main.py 中的 sys.path 操作**
   - 第 12 行：`sys.path.insert(0, ...)` 应是不必要的
   - 应依赖于正确的包安装方式
   - 优先级：低

3. **package.json 引用了已删除的 bin/ 文件**
   - 第 6-7 行：postinstall/update 脚本引用了不存在的文件
   - 需要更新或移除这些脚本
   - 优先级：中

---

## 📊 **指标与目标**

### 测试覆盖率目标
- 当前：0% (测试刚创建)
- 目标 v4.1.7：50%
- 目标 v4.2.0：80%
- 目标 v5.0：90%

### 文档目标
- 当前：60% (README 较好，但缺少细节)
- 目标 v4.1.7：70%
- 目标 v4.2.0：85%
- 目标 v5.0：95%

### 性能目标
- 并行执行：3.5 倍加速 (已实现)
- Token 效率：通过合理的预算减少 30-50%
- 信心检查投资回报率 (ROI)：节省 25-250 倍的 Token

---

## 🔄 **待办事项库 (未排序)**

- [ ] 添加 pre-commit 钩子
- [ ] 建立 CI/CD 流水线
- [ ] 添加基准测试套件
- [ ] 创建 Docker 镜像
- [ ] 添加遥测功能 (选择性加入)
- [ ] 创建 VS Code 扩展
- [ ] 添加交互式教程
- [ ] 实现代理编排
- [ ] 添加工作流自动化
- [ ] 创建插件模板

---

## 📝 **贡献者注意事项**

### 如何使用此文件

1. **开始工作**：从“高优先级”章节挑选任务
2. **完成任务**：移动到“已完成”并更新状态
3. **添加任务**：添加到相应的优先级章节，并注明：
   - 清晰的描述
   - 验收标准
   - 预估工作量
   - 优先级级别

### 任务状态值
- **TODO**：未开始
- **IN PROGRESS**：正在进行中
- **BLOCKED**：由于外部依赖而阻塞
- **REVIEW**：等待代码审查
- **DONE**：已完成并合并

### 优先级级别
- **CRITICAL**：阻碍发布，必须立即修复
- **HIGH**：对下一个版本很重要
- **MEDIUM**：锦上添花，计划在未来版本实现
- **LOW**：未来增强项，无紧迫时间表

---

## 🤝 **需要帮助？**

- **关于任务的问题**：在 GitHub 上开启 Issue
- **想要领取任务**：在相关的 Issue 或 PR 下留言
- **在实现上遇到瓶颈**：查看 KNOWLEDGE.md 获取见解
- **架构疑问**：查阅 PLANNING.md

---

*此文件由社区活跃维护并经常更新。请经常回来查看新的任务和优先级。*

**下次例行审查日期**：2025-11-19 (周考)
